<div class="profile-container">
  <!-- Header Section -->
  <div class="page-header">
    <div class="header-content">
      <h1>Company Profile</h1>
      <p class="subtitle">View and manage your company information</p>
    </div>
    
    <button class="logout-btn" (click)="logout()">
      <i class="fa-solid fa-right-from-bracket"></i>
      Logout
    </button>
  </div>

  <!-- Company Overview Card -->
  <div class="overview-card">
    <div class="card-header">
      <h2>Company Overview</h2>
      <button class="edit-btn" (click)="editProfile()">
        <i class="fa-solid fa-pen"></i>
        Edit Profile
      </button>
    </div>

    <div class="company-header">
      <div class="logo-section">
        <div class="logo-placeholder" (click)="uploadLogo()">
          <i class="fa-solid fa-building" *ngIf="!companyData.logo"></i>
          <img [src]="companyData.logo" *ngIf="companyData.logo" alt="Company Logo">
          <div class="upload-overlay">
            <i class="fa-solid fa-camera"></i>
            <span>Upload Logo</span>
          </div>
        </div>
        <input 
          type="file" 
          #logoInput 
          accept="image/*" 
          (change)="onLogoSelected($event)"
          style="display: none;">
      </div>

      <div class="company-main-info">
        <h3>{{companyData.name}}</h3>
        <p class="sector">{{companyData.sector}}</p>
        <div class="identifiers">
          <span class="id-badge">
            <i class="fa-solid fa-id-card"></i>
            KRA PIN: {{companyData.kraPin}}
          </span>
          <span class="id-badge">
            <i class="fa-solid fa-building"></i>
            Reg No: {{companyData.regNumber}}
          </span>
        </div>
      </div>
    </div>

    <div class="info-grid">
      <div class="info-item">
        <div class="info-icon email">
          <i class="fa-solid fa-envelope"></i>
        </div>
        <div class="info-content">
          <label>Email Address</label>
          <span>{{companyData.email}}</span>
        </div>
      </div>

      <div class="info-item">
        <div class="info-icon phone">
          <i class="fa-solid fa-phone"></i>
        </div>
        <div class="info-content">
          <label>Phone Number</label>
          <span>{{companyData.phone}}</span>
        </div>
      </div>

      <div class="info-item">
        <div class="info-icon address">
          <i class="fa-solid fa-location-dot"></i>
        </div>
        <div class="info-content">
          <label>Head Office</label>
          <span>{{companyData.address}}</span>
        </div>
      </div>

      <div class="info-item">
        <div class="info-icon sector">
          <i class="fa-solid fa-industry"></i>
        </div>
        <div class="info-content">
          <label>Business Sector</label>
          <span>{{companyData.sector}}</span>
        </div>
      </div>

      <div class="info-item">
        <div class="info-icon registration">
          <i class="fa-solid fa-file-contract"></i>
        </div>
        <div class="info-content">
          <label>Registration Number</label>
          <span>{{companyData.regNumber}}</span>
        </div>
      </div>

      <div class="info-item">
        <div class="info-icon date">
          <i class="fa-solid fa-calendar-check"></i>
        </div>
        <div class="info-content">
          <label>Date of Incorporation</label>
          <span>{{companyData.incorporationDate}}</span>
        </div>
      </div>

      <div class="info-item">
        <div class="info-icon tax">
          <i class="fa-solid fa-receipt"></i>
        </div>
        <div class="info-content">
          <label>Tax Compliance Status</label>
          <span class="status-badge compliant">
            <i class="fa-solid fa-circle-check"></i>
            Compliant
          </span>
        </div>
      </div>

      <div class="info-item">
        <div class="info-icon employees">
          <i class="fa-solid fa-users"></i>
        </div>
        <div class="info-content">
          <label>Number of Employees</label>
          <span>{{companyData.employees}}</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Registration Progress Section -->
  <div class="progress-card">
    <div class="progress-header">
      <div>
        <h2>Registration Overview</h2>
        <p class="progress-description">Complete your profile setup to unlock all features</p>
      </div>
      <div class="progress-badge">
        <span class="percentage">{{profileCompletion}}%</span>
        <span class="label">Complete</span>
      </div>
    </div>

    <div class="progress-bar-container">
      <div class="progress-track">
        <div 
          class="progress-fill" 
          [style.width.%]="profileCompletion"
          [class.almost-complete]="profileCompletion >= 80"
          [class.complete]="profileCompletion === 100">
        </div>
      </div>
      <div class="progress-milestones">
        <span 
          *ngFor="let milestone of [25, 50, 75, 100]" 
          class="milestone" 
          [class.reached]="profileCompletion >= milestone"
          [style.left.%]="milestone">
        </span>
      </div>
    </div>

    <div class="completion-hints" *ngIf="profileCompletion < 100">
      <div class="hint-icon">
        <i class="fa-solid fa-lightbulb"></i>
      </div>
      <div class="hint-content">
        <h4>Almost there!</h4>
        <p>{{getCompletionHint()}}</p>
      </div>
    </div>

    <div class="completion-checklist">
      <div class="checklist-item" [class.completed]="companyData.logo">
        <i class="fa-solid" [class.fa-circle-check]="companyData.logo" [class.fa-circle]="!companyData.logo"></i>
        <span>Company logo uploaded</span>
      </div>
      <div class="checklist-item" [class.completed]="companyData.kraPin">
        <i class="fa-solid" [class.fa-circle-check]="companyData.kraPin" [class.fa-circle]="!companyData.kraPin"></i>
        <span>KRA PIN verified</span>
      </div>
      <div class="checklist-item" [class.completed]="companyData.complianceCert">
        <i class="fa-solid" [class.fa-circle-check]="companyData.complianceCert" [class.fa-circle]="!companyData.complianceCert"></i>
        <span>Compliance certificate uploaded</span>
      </div>
      <div class="checklist-item" [class.completed]="companyData.bankDetails">
        <i class="fa-solid" [class.fa-circle-check]="companyData.bankDetails" [class.fa-circle]="!companyData.bankDetails"></i>
        <span>Bank details provided</span>
      </div>
    </div>

    <button class="complete-profile-btn" *ngIf="profileCompletion < 100" (click)="completeProfile()">
      <i class="fa-solid fa-rocket"></i>
      Complete Profile Setup
    </button>
  </div>

  <!-- Financial Summary Section -->
  <div class="financial-section">
    <div class="section-header">
      <h2>Financial Summary</h2>
      <div class="period-selector">
        <button 
          *ngFor="let period of periods" 
          class="period-btn" 
          [class.active]="selectedPeriod === period"
          (click)="selectedPeriod = period">
          {{period}}
        </button>
      </div>
    </div>

    <div class="metrics-grid">
      <div class="metric-card green">
        <div class="metric-icon">
          <i class="fa-solid fa-sack-dollar"></i>
        </div>
        <div class="metric-content">
          <label>Annual Turnover</label>
          <h3>{{financialData.turnover}}</h3>
          <div class="metric-trend up">
            <i class="fa-solid fa-arrow-trend-up"></i>
            <span>12% from last year</span>
          </div>
        </div>
        <div class="metric-status">
          <i class="fa-solid fa-circle-check"></i>
        </div>
      </div>

      <div class="metric-card blue">
        <div class="metric-icon">
          <i class="fa-solid fa-wallet"></i>
        </div>
        <div class="metric-content">
          <label>Net Income</label>
          <h3>{{financialData.netIncome}}</h3>
          <div class="metric-trend up">
            <i class="fa-solid fa-arrow-trend-up"></i>
            <span>8% from last year</span>
          </div>
        </div>
        <div class="metric-status">
          <i class="fa-solid fa-circle-check"></i>
        </div>
      </div>

      <div class="metric-card amber">
        <div class="metric-icon">
          <i class="fa-solid fa-users"></i>
        </div>
        <div class="metric-content">
          <label>Payroll Expenses</label>
          <h3>{{financialData.payroll}}</h3>
          <div class="metric-trend stable">
            <i class="fa-solid fa-minus"></i>
            <span>Stable</span>
          </div>
        </div>
        <div class="metric-status">
          <i class="fa-solid fa-circle-info"></i>
        </div>
      </div>

      <div class="metric-card purple">
        <div class="metric-icon">
          <i class="fa-solid fa-percent"></i>
        </div>
        <div class="metric-content">
          <label>VAT Declared</label>
          <h3>{{financialData.vat}}</h3>
          <div class="metric-trend down">
            <i class="fa-solid fa-arrow-trend-down"></i>
            <span>3% from last quarter</span>
          </div>
        </div>
        <div class="metric-status">
          <i class="fa-solid fa-circle-exclamation"></i>
        </div>
      </div>
    </div>

    <!-- Additional Financial Details -->
    <div class="financial-details">
      <div class="detail-card">
        <div class="detail-header">
          <h3>Tax Payments</h3>
          <span class="view-all">View All <i class="fa-solid fa-arrow-right"></i></span>
        </div>
        <div class="detail-content">
          <div class="payment-item">
            <div class="payment-info">
              <span class="payment-type">Corporate Tax</span>
              <span class="payment-date">Oct 15, 2025</span>
            </div>
            <span class="payment-amount">KSh 2.4M</span>
          </div>
          <div class="payment-item">
            <div class="payment-info">
              <span class="payment-type">VAT Return</span>
              <span class="payment-date">Oct 10, 2025</span>
            </div>
            <span class="payment-amount">KSh 890K</span>
          </div>
          <div class="payment-item">
            <div class="payment-info">
              <span class="payment-type">PAYE</span>
              <span class="payment-date">Oct 5, 2025</span>
            </div>
            <span class="payment-amount">KSh 1.2M</span>
          </div>
        </div>
      </div>

      <div class="detail-card">
        <div class="detail-header">
          <h3>Upcoming Deadlines</h3>
          <span class="view-all">View All <i class="fa-solid fa-arrow-right"></i></span>
        </div>
        <div class="detail-content">
          <div class="deadline-item urgent">
            <div class="deadline-icon">
              <i class="fa-solid fa-exclamation"></i>
            </div>
            <div class="deadline-info">
              <span class="deadline-type">VAT Return Filing</span>
              <span class="deadline-date">Due in 3 days</span>
            </div>
          </div>
          <div class="deadline-item warning">
            <div class="deadline-icon">
              <i class="fa-solid fa-clock"></i>
            </div>
            <div class="deadline-info">
              <span class="deadline-type">Quarterly Tax Payment</span>
              <span class="deadline-date">Due in 12 days</span>
            </div>
          </div>
          <div class="deadline-item normal">
            <div class="deadline-icon">
              <i class="fa-solid fa-calendar"></i>
            </div>
            <div class="deadline-info">
              <span class="deadline-type">Annual Return Submission</span>
              <span class="deadline-date">Due in 45 days</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Quick Actions Section -->
  <div class="actions-section">
    <h2>Quick Actions</h2>
    <div class="actions-grid">
      <button class="action-card" (click)="downloadCertificate()">
        <div class="action-icon">
          <i class="fa-solid fa-file-pdf"></i>
        </div>
        <h3>Download Tax Certificate</h3>
        <p>Get your latest tax compliance certificate</p>
      </button>

      <button class="action-card" (click)="updateBankDetails()">
        <div class="action-icon">
          <i class="fa-solid fa-building-columns"></i>
        </div>
        <h3>Update Bank Details</h3>
        <p>Manage your banking information</p>
      </button>

      <button class="action-card" (click)="viewAuditLogs()">
        <div class="action-icon">
          <i class="fa-solid fa-clock-rotate-left"></i>
        </div>
        <h3>View Audit Logs</h3>
        <p>Track all account activities</p>
      </button>

      <button class="action-card" (click)="contactSupport()">
        <div class="action-icon">
          <i class="fa-solid fa-headset"></i>
        </div>
        <h3>Contact Support</h3>
        <p>Get help from our team</p>
      </button>
    </div>
  </div>
</div>

<!-- Edit Profile Modal -->
<div class="modal-overlay" *ngIf="showEditModal" (click)="closeEditModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2>Edit Company Profile</h2>
      <button class="close-btn" (click)="closeEditModal()">
        <i class="fa-solid fa-xmark"></i>
      </button>
    </div>
    
    <div class="modal-body">
      <div class="form-group">
        <label>Company Name</label>
        <input type="text" class="form-input" [(ngModel)]="editData.name">
      </div>
      
      <div class="form-row">
        <div class="form-group">
          <label>Email</label>
          <input type="email" class="form-input" [(ngModel)]="editData.email">
        </div>
        <div class="form-group">
          <label>Phone</label>
          <input type="tel" class="form-input" [(ngModel)]="editData.phone">
        </div>
      </div>
      
      <div class="form-group">
        <label>Address</label>
        <input type="text" class="form-input" [(ngModel)]="editData.address">
      </div>
      
      <div class="form-row">
        <div class="form-group">
          <label>Sector</label>
          <select class="form-input" [(ngModel)]="editData.sector">
            <option value="Technology">Technology</option>
            <option value="Finance">Finance</option>
            <option value="Manufacturing">Manufacturing</option>
            <option value="Services">Services</option>
            <option value="Retail">Retail</option>
          </select>
        </div>
        <div class="form-group">
          <label>Employees</label>
          <input type="number" class="form-input" [(ngModel)]="editData.employees">
        </div>
      </div>
    </div>
    
    <div class="modal-footer">
      <button class="secondary-btn" (click)="closeEditModal()">Cancel</button>
      <button class="primary-btn" (click)="saveProfile()">
        <i class="fa-solid fa-floppy-disk"></i>
        Save Changes
      </button>
    </div>
  </div>
</div>